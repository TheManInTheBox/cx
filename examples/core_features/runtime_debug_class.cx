// Runtime Debug Test - Class-based test to debug service processing
// All event handlers and logic contained within a conscious class

conscious RuntimeDebugger
{
    realize(self: conscious)
    {
        learn self;
        
        print("ğŸ” RUNTIME DEBUG TEST STARTING (CLASS-BASED)");
        print("==============================================");

        print("âœ… Testing service event processing with class handlers...");

        // Test LearnService with simple request
        learn {
            data: {
                content: "Simple learn test",
                type: "debug_test"
            },
            handlers: [ "learn.debug.complete" ]
        };

        print("âœ… Learn request sent");

        // Test InferService with 2+2 calculation
        infer {
            context: "What is 2+2?",
            data: {
                prompt: "Calculate 2+2 and provide the result",
                type: "math_calculation",
                operation: "addition"
            },
            handlers: [ "infer.debug.complete" ]
        };

        print("âœ… Infer request sent for 2+2 calculation");
        
        // Wait for processing
        await { reason: "Wait for service processing", minDurationMs: 3000, maxDurationMs: 6000 };

        print("ğŸ” RUNTIME DEBUG TEST COMPLETE");
        print("If you see CAUGHT messages above, services are working");
        print("If not, there may be service registration or processing issues");
    }

    // Class-based event handlers (inside conscious class)
    on learn.debug.complete (event) {
        print("ğŸ¯ CAUGHT: learn.debug.complete event (class handler)");
        print("ğŸ” Event data:");
        print(event.data);
        print("ğŸ“š Vector stored: " + event.vectorStored);
        print("âœ… LearnService is processing events in class!");
    }

    on infer.debug.complete (event) {
        print("ğŸ¯ CAUGHT: infer.debug.complete event (class handler)");
        print("ğŸ” Context: " + event.context);
        print("ğŸ§® Calculation result:");
        print(event.result);
        print("âœ… InferService processed 2+2 calculation in class!");
    }

    on inference.complete (event) {
        print("ğŸ¯ CAUGHT: inference.complete event (class handler)");
        print("ğŸ§® 2+2 result:");
        print(event.result);
        print("âœ… Math calculation completed successfully in class!");
    }
}

// Create and run the test
var debugger = new RuntimeDebugger({ });
print("ğŸ§  Runtime debug test with class-based event handlers completed");
