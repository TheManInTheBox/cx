
// TARGET SCENARIO: Aura Live Audio Presence System
// - Agent listens continuously for "Aura on/off" commands only
// - When Aura on: beep-boop acknowledgment + conversation mode
// - When Aura off: disable all reactions except audio listening
// - Animal from Muppets personality with wild beep-boop responses

class AuraAnimalAgent
{
    name: string;
    isAwake: boolean;
    inConversation: boolean;
    auraEnabled: boolean;
    
    constructor(agentName)
    {
        this.name = agentName;
        this.isAwake = false;
        this.inConversation = false;
        this.auraEnabled = false;
        print("ğŸ§ " + this.name + " - Always listening for 'Aura on/off' commands");
    }
    
    function speakBeepBoop(message, isActivation)
    {
        if (isActivation)
        {
            // Wild, excited Animal activation
            var activationSound = "[Wild, chaotic Animal from Muppets voice] BEEP-BOOP! BEEP-BOOP! " + message + " DRUMS! CYMBALS! BEEP-BOOP!";
            tts.SpeakAsync(activationSound);
            print("ğŸ¥ ANIMAL (excited): BEEP-BOOP! " + message + " BEEP-BOOP!");
        }
        else
        {
            // Calmer Animal shutdown
            var shutdownSound = "[Tired Animal voice] beep-boop... " + message + " ...zzz...beep-boop";
            tts.SpeakAsync(shutdownSound);
            print("ğŸ˜´ ANIMAL (sleepy): beep-boop... " + message + " ...beep-boop");
        }
    }
    
    function generateAnimalResponse(userInput)
    {
        var prompt = "Respond as Animal from the Muppets - wild, enthusiastic, broken English, " +
                    "drum references, short energetic phrases. To: '" + userInput + "'";
        
        var response = textGen.GenerateAsync(prompt, {
            temperature: 0.9,
            maxTokens: 60
        });
        
        return response;
    }
    
    function speakAnimalResponse(text)
    {
        var animalVoice = "[Wild, energetic Animal from Muppets voice] " + text;
        tts.SpeakAsync(animalVoice);
        print("ğŸ· ANIMAL: " + text);
    }
    
    // AUDIO PROCESSING - Always active for "Aura on/off" detection
    on live.audio (payload)
    {
        var audioText = payload.toLowerCase();
        print("ğŸ¤ Live audio: " + payload);
        
        // AURA ACTIVATION: "Aura on" command
        if (audioText.includes("aura on"))
        {
            this.auraEnabled = true;
            this.isAwake = true;
            this.inConversation = true;
            
            // Animal's wild beep-boop activation response
            this.speakBeepBoop("ANIMAL AWAKE! AURA READY! ME LISTEN NOW!", true);
            print("âœ… AURA SYSTEM: ON - All sensory systems active");
            
            emit aura.system.activated, this.name;
            return;
        }
        
        // AURA DEACTIVATION: "Aura off" command  
        if (audioText.includes("aura off"))
        {
            this.auraEnabled = false;
            this.isAwake = false;
            this.inConversation = false;
            
            // Animal's sleepy beep-boop shutdown response
            this.speakBeepBoop("ANIMAL SLEEP NOW... AURA OFF... DRUMS QUIET...", false);
            print("âŒ AURA SYSTEM: OFF - Only audio listening remains");
            
            emit aura.system.deactivated, this.name;
            return;
        }
        
        // CONVERSATION PROCESSING - Only when Aura is enabled
        if (this.auraEnabled && this.isAwake && this.inConversation)
        {
            // Check for conversation end signal
            if (audioText.includes("beep-boop"))
            {
                this.inConversation = false;
                this.speakBeepBoop("BYE-BYE! ANIMAL HAD FUN! DRUMS ROCK!", false);
                print("ğŸ‘‹ Conversation ended - demo complete!");
                
                emit conversation.ended, "beep-boop";
                return;
            }
            
            // Generate Animal conversation response
            var animalResponse = this.generateAnimalResponse(payload);
            this.speakAnimalResponse(animalResponse);
        }
        else if (!this.auraEnabled)
        {
            // Aura disabled - ignore all input except activation commands
            print("ğŸ”‡ Aura disabled - ignoring: " + payload);
        }
    }
    
    // PRESENCE DETECTION - Only responds when Aura system is enabled
    on presence.detected (payload)
    {
        if (!this.auraEnabled || !this.isAwake)
        {
            print("ğŸ”‡ Presence ignored - Aura system disabled");
            return;
        }
        
        print("ğŸ‘ï¸ Presence detected: " + payload);
        var presenceResponse = this.generateAnimalResponse("Someone here! Animal see you!");
        this.speakAnimalResponse(presenceResponse);
    }
    
    // ENVIRONMENTAL SENSING - Only active when Aura enabled
    on environment.change (payload)
    {
        if (!this.auraEnabled || !this.isAwake)
        {
            print("ğŸ”‡ Environmental change ignored - Aura system disabled");
            return;
        }
        
        print("ğŸŒ Environment: " + payload);
        var envResponse = this.generateAnimalResponse("Something different! Animal notice!");
        this.speakAnimalResponse(envResponse);
    }
}

// System Monitor for Aura state changes
class AuraSystemMonitor
{
    on aura.system.activated (payload)
    {
        print("ğŸ“Š SYSTEM STATE: Aura ENABLED");
        print("ğŸ“Š Active Services: Audio âœ… | Presence âœ… | Environment âœ… | Conversation âœ…");
    }
    
    on aura.system.deactivated (payload)
    {
        print("ğŸ“Š SYSTEM STATE: Aura DISABLED");
        print("ğŸ“Š Active Services: Audio âœ… | Presence âŒ | Environment âŒ | Conversation âŒ");
    }
    
    on conversation.ended (payload)
    {
        print("ğŸ“Š CONVERSATION: Ended by " + payload);
        print("ğŸ“Š Demo Status: Complete - Target scenario achieved!");
    }
}

// INITIALIZE TARGET SCENARIO DEMO
print("ğŸš€ AURA LIVE AUDIO PRESENCE - TARGET SCENARIO");
print("===============================================");
print("ğŸ¯ SCENARIO: Voice-activated sensory system with Animal personality");
print("ğŸ§ LISTENING: Always listening for 'Aura on' and 'Aura off' commands");
print("ğŸ”Š RESPONSE: Animal from Muppets with wild beep-boop acknowledgments");
print("ğŸ’¬ CONVERSATION: Active only when Aura system is enabled");
print("ğŸ›‘ END: Say 'beep-boop' to end conversation and complete demo");
print("");

try
{
    // Create the Aura system agents
    var animalAgent = agent AuraAnimalAgent("ANIMAL");
    var systemMonitor = agent AuraSystemMonitor();
    
    print("ğŸ¤ SIMULATION: Live audio processing scenario");
    print("");
    
    // === STEP 1: USER SAYS "Aura on" ===
    print("ğŸ‘¤ USER: 'Aura on'");
    emit live.audio, "Aura on";
    
    print("");
    
    // === STEP 2: USER STARTS CONVERSATION ===
    print("ğŸ‘¤ USER: 'Hello Animal, how are you today?'");
    emit live.audio, "Hello Animal, how are you today?";
    
    print("");
    
    // === STEP 3: CONTINUE CONVERSATION ===
    print("ğŸ‘¤ USER: 'Do you want to play drums with me?'");
    emit live.audio, "Do you want to play drums with me?";
    
    print("");
    
    // === STEP 4: PRESENCE DETECTION WHILE AURA ACTIVE ===
    print("ğŸ” [PRESENCE SENSOR] Motion detected in room");
    emit presence.detected, "motion";
    
    print("");
    
    // === STEP 5: ENVIRONMENTAL CHANGE ===
    print("ğŸŒ¡ï¸ [ENVIRONMENT SENSOR] Temperature increase detected");
    emit environment.change, "temperature_rise";
    
    print("");
    
    // === STEP 6: END CONVERSATION ===
    print("ğŸ‘¤ USER: 'beep-boop'");
    emit live.audio, "beep-boop";
    
    print("");
    print("ğŸŠ TARGET SCENARIO COMPLETED!");
    print("");
    
    // === BONUS: DEMONSTRATE AURA OFF STATE ===
    print("ğŸ“‹ BONUS: Demonstrating Aura off state...");
    print("ğŸ‘¤ USER: 'Aura off'");
    emit live.audio, "Aura off";
    
    print("");
    print("ğŸ‘¤ USER: 'Hello? Anyone there?'");
    emit live.audio, "Hello? Anyone there?";
    
    print("");
    print("ğŸ” [PRESENCE SENSOR] Motion detected (should be ignored)");
    emit presence.detected, "motion";
    
    print("");
    print("âœ… AURA SYSTEM BEHAVIOR VERIFIED!");
    
}
catch (error)
{
    print("âŒ Target Scenario Error: " + error);
}

// Global audio listener (always active)
on system.audio.always (payload)
{
    print("ğŸ”Š System-wide audio processing: " + payload);
    emit live.audio, payload;
}

print("");
print("ğŸ† TARGET SCENARIO ACHIEVEMENTS:");
print("âœ… Continuous Audio Listening: Always monitoring for 'Aura on/off'");
print("âœ… State Management: Proper enable/disable of sensory processing");
print("âœ… Animal Personality: Wild Muppet character with beep-boop responses"); 
print("âœ… Selective Response: Only reacts when Aura system enabled");
print("âœ… Conversation Flow: Natural start with activation, end with beep-boop");
print("âœ… Multi-Sensory Integration: Audio, presence, environment coordination");
print("");
print("ğŸŒŸ CAPABILITIES DEMONSTRATED:");
print("ğŸ¤ Live Audio Processing - Command detection and conversation");
print("ğŸ¤– Autonomous State Management - System-wide enable/disable");
print("ğŸ­ AI Personality Integration - Animal from Muppets character");
print("ğŸ‘ï¸ Presence Detection - Environmental awareness when active");
print("ğŸŒ Environmental Sensing - Multi-modal sensory input processing");
print("ğŸ”Š Voice Synthesis - Text-to-speech with character personality");
print("");
print("ğŸ¯ TARGET SCENARIO: COMPLETE - Aura Live Audio Presence System Operational!");
