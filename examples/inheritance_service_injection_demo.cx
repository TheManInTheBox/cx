// CX Language - Inheritance-Based Service Injection Demo
// Shows the new cleaner syntax without explicit 'uses' declarations

print("ğŸ”„ Testing Inheritance-Based Service Injection");
print("==============================================");

// Method 1: Interface-based service injection
// Classes that implement service interfaces automatically get those services
class SmartAgent : ITextGeneration, ITextToSpeech
{
    async function greet(name)
    {
        print("ğŸ¤– Smart Agent initializing...");
        
        // Service access without 'uses' declarations!
        // textGen and tts are automatically available through inheritance
        var greeting = await textGen.GenerateAsync("Generate a friendly greeting for " + name);
        
        print("ğŸ’¬ Generated greeting: " + greeting);
        
        // TTS also automatically available
        await tts.SpeakAsync(greeting);
        
        return greeting;
    }
}

// Method 2: Base class inheritance with specific interfaces
class AdvancedAgent : ServiceBase, IFullAICapabilities
{
    async function processRequest(query)
    {
        print("ğŸ§  Advanced Agent processing: " + query);
        
        // All AI services automatically available:
        // textGen, tts, chat, embeddings, imageGen, audioToText, etc.
        
        var response = await textGen.GenerateAsync("Process this request: " + query);
        var embedding = await embeddings.GenerateEmbeddingAsync(query);
        
        print("ğŸ“Š Generated embedding vector length: " + embedding.length);
        
        await tts.SpeakAsync(response);
        
        return {
            response: response,
            embedding: embedding,
            processed: true
        };
    }
}

// Method 3: Selective service interfaces
class ImageProcessor : IImageGeneration, IImageAnalysis
{
    async function createAndAnalyze(prompt)
    {
        print("ğŸ¨ Image Processor working on: " + prompt);
        
        // Only imageGen and imageToText available (as requested via interfaces)
        var imageUrl = await imageGen.GenerateAsync(prompt);
        var analysis = await imageToText.AnalyzeAsync(imageUrl);
        
        return {
            imageUrl: imageUrl,
            analysis: analysis
        };
    }
}

try
{
    print("\nğŸ¯ Test 1: Interface-based service injection");
    var agent1 = new SmartAgent();
    var greeting = await agent1.greet("Developer");
    print("âœ… Test 1 passed: " + greeting);
    
    print("\nğŸ¯ Test 2: Full AI capabilities inheritance");
    var agent2 = new AdvancedAgent();
    var result = await agent2.processRequest("What's the weather like?");
    print("âœ… Test 2 passed - Response: " + result.response);
    
    print("\nğŸ¯ Test 3: Selective service interfaces");
    var processor = new ImageProcessor();
    var imageResult = await processor.createAndAnalyze("A beautiful sunset");
    print("âœ… Test 3 passed - Image: " + imageResult.imageUrl);
    
    print("\nğŸ‰ ALL TESTS PASSED!");
    print("ğŸš€ Inheritance-based service injection working perfectly!");
    
}
catch (error)
{
    print("âŒ Test failed: " + error.message);
}
