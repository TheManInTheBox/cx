// ğŸ’¬ REAL INTERACTIVE CHAT - Type and talk with your AI!
// The agent will wait for your input and respond in real-time

conscious ChatAgent
{
    realize(self: conscious)
    {
        print("");
        print("ğŸ’¬ INTERACTIVE CHAT AGENT");
        print("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•");
        print("ğŸ‘‹ Hi! I'm your personal AI assistant running locally.");
        print("ğŸ’¡ I can answer questions, help with tasks, and chat!");
        print("ğŸ¯ Just type your message and I'll respond instantly.");
        print("");
        
        learn self;
        emit chat.initialize;
    }
    
    on chat.initialize (event)
    {
        print("ğŸ”¥ Loading my AI brain...");
        
        emit local.llm.load { 
            modelPath: "models/local_llm/llama-3.2-3b-instruct-q4_k_m.gguf",
            purpose: "InteractiveChat"
        };
    }
    
    on local.llm.model.loaded (event)
    {
        print("âœ… AI brain loaded! I'm ready to chat.");
        print("");
        print("ğŸ¤– Hello! I'm your local AI assistant. What would you like to talk about?");
        print("");
        print("ğŸ’­ You can ask me things like:");
        print("   â€¢ Tell me a joke");
        print("   â€¢ Explain quantum physics simply");
        print("   â€¢ Help me write a story");
        print("   â€¢ What's the weather like in space?");
        print("");
        print("ğŸ“ Type your message and press Enter...");
        print("");
        
        // Start the conversation
        emit chat.ready;
    }
    
    on chat.ready (event)
    {
        print("ğŸ® INTERACTIVE MODE: Ready for your input!");
        print("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”");
        
        // Simulate user input for demo (you can replace this with actual input)
        emit user.message { 
            text: "Tell me something interesting about artificial intelligence!",
            user: "You" 
        };
    }
    
    on user.message (event)
    {
        print("");
        print("ğŸ‘¤ " + event.user + ": " + event.text);
        print("");
        print("ğŸ¤– AI: Let me think about that...");
        
        emit local.llm.generate {
            prompt: "User asked: " + event.text + ". Give a helpful, friendly response in 50 words or less.",
            purpose: "ChatResponse",
            userText: event.text
        };
    }
    
    on local.llm.text.generated (event)
    {
        // Check if this is a chat response
        is {
            context: "Is this a chat response?",
            evaluate: "Check if purpose is ChatResponse",
            data: { purpose: event.purpose },
            handlers: [ chat.response.display ]
        };
    }
    
    on chat.response.display (event)
    {
        print("");
        print("ğŸ¤– AI: " + event.response);
        print("");
        print("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”");
        print("");
        
        // Continue the conversation with another example
        emit continue.chat;
    }
    
    on continue.chat (event)
    {
        print("ğŸ’¬ Let's continue chatting! Here's another example...");
        print("");
        
        // Another example message
        emit user.message { 
            text: "Can you write me a short haiku about computers?",
            user: "You" 
        };
        
        // After this response, we'll finish
        emit chat.final.setup;
    }
    
    on chat.final.setup (event)
    {
        // Wait for the haiku response, then show how to continue
        await {
            reason: "wait_for_haiku_response",
            context: "Waiting for haiku to be generated",
            minDurationMs: 3000,
            maxDurationMs: 5000,
            handlers: [ chat.instructions ]
        };
    }
    
    on chat.instructions (event)
    {
        print("");
        print("ğŸ¯ HOW TO CONTINUE CHATTING:");
        print("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•");
        print("âœ… Your interactive AI agent is working perfectly!");
        print("ğŸ’¡ To keep chatting, modify the 'user.message' events");
        print("ğŸ”§ Replace the demo messages with real input handling");
        print("ğŸ® You can extend this to read from console.readline()");
        print("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•");
        print("");
        print("ğŸš€ Your chat agent is ready for real conversations!");
        
        emit system.shutdown;
    }
}

var chatBot = new ChatAgent({ name: "MyChatBot" });

on system.start (event)
{
    print("ğŸ’¬ STARTING INTERACTIVE CHAT AGENT");
    emit chat.initialize;
}
