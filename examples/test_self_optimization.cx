// Test self keyword in function context for AI-driven optimization
print("=== Testing Self-Optimization with 'self' keyword ===");

// Built-in functions modify behavior and code at runtime based on conditions
async function selfOptimizingProcess() 
{
    // Built-in reason() function measures current performance
    var currentPerformance = await reason("Analyze current function performance and accuracy");
    
    if (currentPerformance.accuracy < 0.9) 
    {
        // Built-in synthesize() function generates improved version
        
        var improvedCode = await synthesize(
            "Optimize this function for better accuracy: " + self,
            {
                compile_immediately: true,
                test_before_deployment: true,
                rollback_on_failure: true,
                target_language: "cx"
            }
        );
        
        // Built-in adapt() function deploys the improved version autonomously
        var deployment = await adapt("function_upgrade", {
            new_code: improvedCode,
            validation_required: true,
            gradual_rollout: true
        });
        
        return deployment.status;
    }
    
    return "no_optimization_needed";
}

// Test function that uses self for introspection
async function demonstrateSelfIntrospection() 
{
    print("Current function code:");
    print(self);
    
    // Use self in AI operations
    var analysis = await reason("What improvements can be made to this code: " + self);
    print("AI Analysis: " + analysis);
    
    var enhanced = await synthesize("Improve this function: " + self);
    print("Enhanced version: " + enhanced);
}

// Another test function showing self usage
function basicSelfTest() 
{
    print("This function contains: " + self);
    return self;
}

// Run the tests
print("Testing self keyword in functions...");

// Test basic self functionality
var functionCode = basicSelfTest();
print("Returned function code: " + functionCode);

// Test async self with AI
await demonstrateSelfIntrospection();

// Test self-optimization pattern
var optimizationResult = await selfOptimizingProcess();
print("Optimization result: " + optimizationResult);

print("=== Self keyword tests complete ===");
