// SIMPLE WORKING CONSOLE - Real Console.ReadLine() Integration
// Direct connection to ConsoleInputService for actual keyboard input

conscious WorkingConsole
{
    realize(self: conscious)
    {
        learn self;
        emit console.working.start { name: self.name };
    }
    
    on console.working.start (event)
    {
        print("ðŸŽ¯ SIMPLE WORKING CONSOLE");
        print("ðŸ“ Name: " + event.name);
        print("");
        print("âœ… CONSOLE FEATURES:");
        print("  ðŸ“‹ Real Console.ReadLine() integration");
        print("  âŒ¨ï¸ Actual keyboard input processing");
        print("  ðŸ”„ Line-based input (not streaming)");
        print("  ðŸŽ¯ Direct ConsoleInputService connection");
        print("");
        print("ðŸ’¡ HOW TO USE:");
        print("  1. Type a command");
        print("  2. Press Enter");
        print("  3. Command will be processed");
        print("");
        print("ðŸŽ® COMMANDS:");
        print("  hello - Say hello");
        print("  status - Show system status");
        print("  exit - Close console");
        print("");
        
        // Start console input session
        emit console.input.start { mode: "active" };
    }
    
    on console.input.start (event)
    {
        print("âš¡ Console input session starting...");
        print("ðŸ“ Mode: " + event.mode);
        print("");
        print("ðŸŽ¯ Ready for input! Type a command and press Enter:");
        
        // Request first prompt
        emit console.prompt { prompt: "CX> " };
    }
    
    // Handle actual console input from ConsoleInputService
    on console.input (event)
    {
        print("");
        print("ðŸ“¥ Input received: '" + event.text + "'");
        print("ðŸ“Š Source: " + event.source);
        print("");
        
        // Process the input
        emit command.process { 
            input: event.text,
            source: event.source,
            timestamp: event.timestamp || now()
        };
    }
    
    on command.process (event)
    {
        var input = event.input;
        
        print("ðŸ”§ Processing command: '" + input + "'");
        print("");
        
        // Route commands using cognitive boolean logic
        is {
            context: "Command routing for console input",
            evaluate: "User typed 'hello' command",
            data: { input: input, command: "hello" },
            handlers: [ command.hello ]
        };
        
        is {
            context: "Command routing for console input", 
            evaluate: "User typed 'status' command",
            data: { input: input, command: "status" },
            handlers: [ command.status ]
        };
        
        is {
            context: "Command routing for console input",
            evaluate: "User typed 'exit' command",
            data: { input: input, command: "exit" },
            handlers: [ command.exit ]
        };
        
        not {
            context: "Command validation for console input",
            evaluate: "Command is recognized",
            data: { input: input },
            handlers: [ command.unknown ]
        };
    }
    
    on command.hello (event)
    {
        print("ðŸ‘‹ Hello! Console is working perfectly!");
        print("âœ… Input: '" + event.input + "'");
        print("ðŸŽ¯ Console.ReadLine() integration successful");
        print("");
        
        emit ready.next.input;
    }
    
    on command.status (event)
    {
        print("ðŸ“Š SYSTEM STATUS:");
        print("  ðŸ”§ ConsoleInputService: âœ… Active");
        print("  ðŸ“ Console.ReadLine(): âœ… Working");
        print("  âŒ¨ï¸ Keyboard Input: âœ… Functional");
        print("  ðŸ§  Event Processing: âœ… Operational");
        print("  ðŸŽ¯ Command Routing: âœ… Active");
        print("");
        
        emit ready.next.input;
    }
    
    on command.exit (event)
    {
        print("ðŸ‘‹ Goodbye! Console session ending...");
        print("âœ… Console.ReadLine() worked correctly");
        print("ðŸŽ¯ Line-based input confirmed functional");
        print("");
        
        emit system.shutdown { reason: "user_exit" };
    }
    
    on command.unknown (event)
    {
        print("âŒ Unknown command: '" + event.input + "'");
        print("ðŸ’¡ Available commands: hello, status, exit");
        print("");
        
        emit ready.next.input;
    }
    
    on ready.next.input (event)
    {
        print("ðŸ”„ Ready for next command:");
        
        // Request next prompt from ConsoleInputService
        emit console.prompt { prompt: "CX> " };
    }
}

// Create and start the working console
var workingConsole = new WorkingConsole({ name: "SimpleWorkingConsole" });

// Start the console
emit console.working.start { name: "SimpleWorkingConsole" };
