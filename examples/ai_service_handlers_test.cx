// Test AI service statements with handlers pattern
// Demonstrating the modern CX syntax: learn, { ... handlers: { ... } }

class AiAgent
{
    name: string = "TestAgent";
    
    constructor(agentName: string)
    {
        this.name = agentName;
        print("AI Agent created: " + this.name);
    }
    
    function processData(input: string)
    {
        print("Processing input: " + input);
        
        // Modern CX pattern: AI service calls with enhanced handlers
        learn {
            agent: this.name,
            content: input,
            context: "data_processing",
            handlers: [ 
                any.complete { status: "learned" }, 
                agent.task.done, 
                search.for.work { query: "related topics" } 
            ]
        };
        
        think {
            prompt: "analyze: " + input,
            agent: this.name,
            handlers: [ 
                thinking.complete, 
                analysis.ready { type: "deep" } 
            ]
        };
        
        generate {
            prompt: "create summary of: " + input,
            type: "summary",
            handlers: [ 
                content.generated { format: "markdown" }, 
                summary.complete 
            ]
        };
    }
    
    // Event handlers to catch the results
    on ai.learn.request (event)
    {
        print("Learn request received for agent: " + event.agent);
        print("Content: " + event.content);
    }
    
    on ai.think.request (event)
    {
        print("Think request received: " + event.prompt);
    }
    
    on ai.generate.request (event)
    {
        print("Generate request received: " + event.prompt);
    }
    
    // Handlers triggered by the handlers property
    on any.complete (event)
    {
        print("Handler 'any.complete' triggered for agent: " + event.agent + " with status: " + event.status);
    }
    
    on agent.task.done (event)
    {
        print("Handler 'agent.task.done' triggered for agent: " + event.agent);
    }
    
    on search.for.work (event)
    {
        print("Handler 'search.for.work' triggered with query: " + event.query);
    }
    
    on thinking.complete (event)
    {
        print("Handler 'thinking.complete' triggered for prompt: " + event.prompt);
    }
    
    on analysis.ready (event)
    {
        print("Handler 'analysis.ready' triggered with type: " + event.type);
    }
    
    on content.generated (event)
    {
        print("Handler 'content.generated' triggered with format: " + event.format);
    }
    
    on summary.complete (event)
    {
        print("Handler 'summary.complete' triggered for prompt: " + event.prompt);
    }
}

// Create agent and test
var agent = new AiAgent("SmartAgent");
agent.processData("Test data for AI processing");
