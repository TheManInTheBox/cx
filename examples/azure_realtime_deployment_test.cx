// Azure OpenAI Realtime API - gpt-4o-mini-realtime-preview Deployment Test
// Testing the newly configured realtime model deployment

print("=== ğŸš€ GPT-4O-MINI-REALTIME-PREVIEW DEPLOYMENT TEST ğŸš€ ===");

class RealtimeDeploymentTestAgent
{
    name: string = "DeploymentTester";
    deploymentName: string = "gpt-4o-mini-realtime-preview";
    
    function testNewDeployment()
    {
        print("ğŸ§ª Testing gpt-4o-mini-realtime-preview deployment...");
        print("âœ… Configuration updated: RealtimeDeploymentName = gpt-4o-mini-realtime-preview");
        print("âœ… Endpoint: wss://aaron-md9fkzv3-eastus2.cognitiveservices.azure.com");
        print("âœ… API Version: 2024-10-01-preview");
        print("ğŸ”„ Attempting connection to new deployment...");
        
        // Test connection to new deployment
        emit realtime.connect { 
            test: "deployment_validation",
            deployment: this.deploymentName,
            timestamp: "2025-07-22"
        };
        
        print("ğŸ“¡ Connection request sent to Azure OpenAI Realtime API");
    }
    
    on realtime.connected (event)
    {
        print("ğŸ‰ SUCCESS! Connected to gpt-4o-mini-realtime-preview!");
        print("âœ… Deployment is working correctly");
        print(event);
        
        // Test session creation with new model
        emit realtime.session.create {
            deployment: this.deploymentName,
            test: "session_validation"
        };
    }
    
    on realtime.session.created (event)
    {
        print("ğŸ‰ SESSION CREATED! gpt-4o-mini-realtime-preview is fully operational!");
        print(event);
        
        // Test sending a message
        emit realtime.text.send {
            text: "Hello! This is a test of the gpt-4o-mini-realtime-preview deployment. Please respond to confirm the model is working.",
            deployment: this.deploymentName
        };
    }
    
    on realtime.text.response (event)
    {
        print("ğŸ‰ TEXT RESPONSE RECEIVED! Model is responding correctly!");
        print("Response:");
        print(event);
        
        emit deployment.success {
            model: this.deploymentName,
            status: "fully_operational",
            timestamp: "2025-07-22"
        };
    }
    
    on realtime.session.error (event)
    {
        print("âš ï¸ Deployment test encountered an issue:");
        print(event);
        
        if (event.error && event.error.indexOf("404") >= 0)
        {
            print("âŒ DEPLOYMENT NOT FOUND: gpt-4o-mini-realtime-preview");
            print("ğŸ“‹ NEXT STEPS:");
            print("1. Go to Azure Portal");
            print("2. Navigate to your Azure OpenAI resource: aaron-md9fkzv3-eastus2");
            print("3. Click 'Model deployments'");
            print("4. Deploy model: gpt-4o-mini-realtime-preview");
            print("5. Set deployment name: gpt-4o-mini-realtime-preview");
        }
        else if (event.error && event.error.indexOf("401") >= 0)
        {
            print("âŒ AUTHENTICATION ERROR: Check your API key");
        }
        else if (event.error && event.error.indexOf("403") >= 0)
        {
            print("âŒ PERMISSION ERROR: Model not available in your region");
        }
        else
        {
            print("âŒ OTHER ERROR: Check Azure OpenAI service status");
        }
    }
    
    on deployment.success (event)
    {
        print("ğŸ† DEPLOYMENT SUCCESS! gpt-4o-mini-realtime-preview is ready for production!");
        print("âœ… Configuration: COMPLETE");
        print("âœ… Connection: WORKING");
        print("âœ… Sessions: WORKING");
        print("âœ… Text Processing: WORKING");
        print("ğŸ¯ Azure OpenAI Realtime API is fully operational!");
    }
}

// Create and test the deployment
var deploymentTester = new RealtimeDeploymentTestAgent();

print("\nğŸ”§ CONFIGURATION STATUS:");
print("âœ… Realtime Endpoint: wss://aaron-md9fkzv3-eastus2.cognitiveservices.azure.com");
print("âœ… Deployment Name: gpt-4o-mini-realtime-preview"); 
print("âœ… API Version: 2024-10-01-preview");

print("\nğŸ§ª STARTING DEPLOYMENT TEST:");
deploymentTester.testNewDeployment();

print("\nâ³ Waiting for Azure OpenAI response...");
